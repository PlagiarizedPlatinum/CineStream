<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ReelWave</title>
<link rel="dns-prefetch" href="https://api.themoviedb.org">
<link rel="dns-prefetch" href="https://image.tmdb.org">
<link rel="dns-prefetch" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://image.tmdb.org" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;1,9..40,300&display=swap" rel="stylesheet">
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DESIGN TOKENS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
:root {
  --bg:        #07090d;
  --surface:   #0d1117;
  --card:      #111620;
  --border:    #1c2333;
  --border-hi: #2a3548;
  --accent:    #e8c96d;
  --accent2:   #c4522a;
  --text:      #e8e4dc;
  --text-dim:  #a8a29e;
  --muted:     #5a6478;
  --red:       #e84040;
  --radius:    10px;
  --radius-sm: 6px;
  --shadow-card: 0 8px 32px rgba(0,0,0,0.5);
  --shadow-lg:   0 24px 64px rgba(0,0,0,0.7);
  --transition:  0.22s cubic-bezier(0.4,0,0.2,1);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESET & BASE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

html { scroll-behavior: smooth; }

body {
  background: var(--bg);
  color: var(--text);
  font-family: 'DM Sans', sans-serif;
  min-height: 100vh;
  overflow-x: hidden;
  -webkit-font-smoothing: antialiased;
}

img { display: block; max-width: 100%; }
button { cursor: pointer; }
a { text-decoration: none; color: inherit; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCROLLBAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
::-webkit-scrollbar { width: 5px; height: 5px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--border-hi); border-radius: 99px; }
::-webkit-scrollbar-thumb:hover { background: var(--muted); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ANIMATIONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@keyframes fadeIn    { from { opacity: 0 } to { opacity: 1 } }
@keyframes fadeUp    { from { opacity: 0; transform: translateY(18px) } to { opacity: 1; transform: none } }
@keyframes fadeDown  { from { opacity: 0; transform: translateY(-10px) } to { opacity: 1; transform: none } }
@keyframes scaleIn   { from { opacity: 0; transform: scale(0.96) } to { opacity: 1; transform: scale(1) } }
@keyframes spin      { to { transform: rotate(360deg) } }
@keyframes pulse     { 0%,100% { opacity:1; transform:scale(1) } 50% { opacity:.45; transform:scale(1.5) } }
@keyframes shimmer   {
  0%   { background-position: -400px 0 }
  100% { background-position: 400px 0 }
}
@keyframes heroSlide { from { opacity:0; transform:scale(1.04) } to { opacity:1; transform:scale(1) } }
@keyframes slideUp   { from { transform:translateY(100%); opacity:0 } to { transform:none; opacity:1 } }
@keyframes glow      { 0%,100% { box-shadow:0 0 20px rgba(232,201,109,0.1) } 50% { box-shadow:0 0 40px rgba(232,201,109,0.25) } }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PASSWORD GATE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#pw-gate {
  position: fixed;
  inset: 0;
  z-index: 9999;
  background: radial-gradient(ellipse at 50% 40%, #0e1525 0%, var(--bg) 70%);
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  gap: 32px;
  animation: fadeIn 0.5s ease;
}

#pw-gate::before {
  content: '';
  position: absolute;
  inset: 0;
  background: 
    radial-gradient(ellipse 60% 40% at 20% 80%, rgba(196,82,42,0.06) 0%, transparent 60%),
    radial-gradient(ellipse 50% 50% at 80% 20%, rgba(232,201,109,0.05) 0%, transparent 60%);
  pointer-events: none;
}

.gate-logo {
  font-family: 'Bebas Neue', sans-serif;
  font-size: 52px;
  letter-spacing: 8px;
  color: var(--accent);
  animation: fadeDown 0.6s ease 0.1s both;
}
.gate-logo span { color: var(--accent2); }

.gate-tagline {
  font-size: 11px;
  letter-spacing: 4px;
  text-transform: uppercase;
  color: var(--muted);
  margin-top: -28px;
  animation: fadeDown 0.6s ease 0.2s both;
}

.gate-box {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 40px 44px;
  width: 360px;
  display: flex;
  flex-direction: column;
  gap: 18px;
  box-shadow: var(--shadow-lg);
  animation: fadeUp 0.6s ease 0.2s both;
}

.gate-box h2 {
  font-family: 'Bebas Neue', sans-serif;
  font-size: 22px;
  letter-spacing: 3px;
  text-align: center;
  color: var(--text);
}

.gate-box p {
  font-size: 13px;
  color: var(--muted);
  text-align: center;
  margin-top: -8px;
}

#pw-input {
  background: var(--card);
  border: 1px solid var(--border);
  color: var(--text);
  font-family: 'DM Sans', sans-serif;
  font-size: 15px;
  padding: 14px 18px;
  border-radius: var(--radius-sm);
  outline: none;
  width: 100%;
  transition: border-color var(--transition), box-shadow var(--transition);
}
#pw-input:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(232,201,109,0.1);
}

#pw-submit {
  background: var(--accent);
  color: #000;
  border: none;
  font-family: 'DM Sans', sans-serif;
  font-size: 14px;
  font-weight: 600;
  letter-spacing: 0.5px;
  padding: 14px;
  border-radius: var(--radius-sm);
  width: 100%;
  transition: background var(--transition), transform var(--transition);
}
#pw-submit:hover  { background: #f5d87a; }
#pw-submit:active { transform: scale(0.98); }

#pw-error {
  color: var(--red);
  font-size: 13px;
  text-align: center;
  min-height: 18px;
  animation: fadeIn 0.2s ease;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   APP CONTENT REVEAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#app-content { display: none; }
body.authenticated #app-content { display: block; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HEADER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
header {
  position: fixed;
  top: 0; left: 0; right: 0;
  z-index: 200;
  height: 64px;
  padding: 0 32px;
  display: grid;
  grid-template-columns: auto 1fr auto;
  align-items: center;
  gap: 24px;
  background: linear-gradient(to bottom, rgba(7,9,13,0.97) 60%, transparent);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border-bottom: 1px solid rgba(28,35,51,0.6);
  transition: background var(--transition);
}

.logo {
  font-family: 'Bebas Neue', sans-serif;
  font-size: 26px;
  letter-spacing: 5px;
  color: var(--accent);
  white-space: nowrap;
}
.logo span { color: var(--accent2); }

nav {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 4px;
}

.nav-btn {
  background: none;
  border: none;
  color: var(--muted);
  font-family: 'DM Sans', sans-serif;
  font-size: 12px;
  font-weight: 500;
  letter-spacing: 1.5px;
  text-transform: uppercase;
  padding: 7px 16px;
  border-radius: var(--radius-sm);
  transition: color var(--transition), background var(--transition);
  position: relative;
}
.nav-btn::after {
  content: '';
  position: absolute;
  bottom: -1px; left: 50%; right: 50%;
  height: 2px;
  background: var(--accent);
  border-radius: 2px;
  transition: left var(--transition), right var(--transition);
}
.nav-btn:hover { color: var(--text-dim); }
.nav-btn.active { color: var(--accent); }
.nav-btn.active::after { left: 16px; right: 16px; }

.header-right {
  display: flex;
  align-items: center;
  gap: 10px;
  justify-content: flex-end;
}

/* Search */
.search-wrap {
  position: relative;
  display: flex;
  align-items: center;
}
#search-input {
  background: var(--surface);
  border: 1px solid var(--border);
  color: var(--text);
  font-family: 'DM Sans', sans-serif;
  font-size: 13px;
  padding: 8px 38px 8px 14px;
  border-radius: var(--radius-sm);
  width: 220px;
  outline: none;
  transition: border-color var(--transition), box-shadow var(--transition), width 0.3s ease;
}
#search-input::placeholder { color: var(--muted); }
#search-input:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(232,201,109,0.08);
  width: 280px;
}
.search-icon {
  position: absolute;
  right: 11px;
  color: var(--muted);
  font-size: 17px;
  pointer-events: none;
  line-height: 1;
}

/* Settings trigger */
.settings-trigger {
  display: flex;
  align-items: center;
  justify-content: center;
  background: none;
  border: 1px solid var(--border);
  color: var(--muted);
  width: 36px;
  height: 36px;
  border-radius: var(--radius-sm);
  flex-shrink: 0;
  transition: color var(--transition), border-color var(--transition), background var(--transition);
}
.settings-trigger:hover {
  color: var(--text);
  border-color: var(--border-hi);
  background: var(--surface);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MAIN LAYOUT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
main { padding-top: 64px; min-height: 100vh; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HERO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.hero {
  position: relative;
  height: 560px;
  overflow: hidden;
  display: flex;
  align-items: flex-end;
  padding: 56px 48px;
}

.hero-bg {
  position: absolute;
  inset: 0;
  background-size: cover;
  background-position: center top;
  filter: brightness(0.3) saturate(0.7);
  transition: background-image 0.6s ease, filter 0.8s ease;
  transform: scale(1.02);
  will-change: transform;
}
.hero-bg.transitioning { animation: heroSlide 0.8s ease forwards; }

.hero-vignette {
  position: absolute;
  inset: 0;
  background: 
    linear-gradient(to top,  var(--bg) 0%, rgba(7,9,13,0.8) 30%, rgba(7,9,13,0.1) 65%, transparent 100%),
    linear-gradient(to right, rgba(7,9,13,0.6) 0%, transparent 60%);
}

.hero-content {
  position: relative;
  z-index: 2;
  max-width: 580px;
  animation: fadeUp 0.6s ease;
}

.hero-badge {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  background: var(--accent2);
  color: white;
  font-size: 9px;
  font-weight: 600;
  letter-spacing: 2.5px;
  text-transform: uppercase;
  padding: 5px 12px;
  border-radius: 3px;
  margin-bottom: 14px;
}

.hero-title {
  font-family: 'Bebas Neue', sans-serif;
  font-size: clamp(44px, 6vw, 74px);
  line-height: 0.93;
  letter-spacing: 2px;
  margin-bottom: 18px;
  text-shadow: 0 2px 20px rgba(0,0,0,0.5);
}

.hero-meta {
  display: flex;
  gap: 18px;
  align-items: center;
  margin-bottom: 18px;
  font-size: 12.5px;
  color: var(--text-dim);
  flex-wrap: wrap;
}
.hero-rating { color: var(--accent); font-weight: 600; }

.hero-overview {
  font-size: 14px;
  line-height: 1.75;
  color: rgba(232,228,220,0.7);
  max-width: 460px;
  margin-bottom: 30px;
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.hero-actions { display: flex; gap: 12px; flex-wrap: wrap; }

.btn-play {
  display: inline-flex;
  align-items: center;
  gap: 9px;
  background: var(--accent);
  color: #000;
  border: none;
  font-family: 'DM Sans', sans-serif;
  font-size: 13.5px;
  font-weight: 700;
  letter-spacing: 0.5px;
  padding: 13px 28px;
  border-radius: var(--radius-sm);
  transition: background var(--transition), transform var(--transition), box-shadow var(--transition);
  animation: glow 3s ease-in-out infinite;
}
.btn-play:hover  { background: #f5d87a; transform: translateY(-2px); box-shadow: 0 8px 24px rgba(232,201,109,0.3); }
.btn-play:active { transform: scale(0.97); }

.btn-secondary {
  display: inline-flex;
  align-items: center;
  gap: 9px;
  background: rgba(255,255,255,0.08);
  color: var(--text);
  border: 1px solid rgba(255,255,255,0.14);
  font-family: 'DM Sans', sans-serif;
  font-size: 13.5px;
  font-weight: 500;
  padding: 13px 28px;
  border-radius: var(--radius-sm);
  backdrop-filter: blur(10px);
  transition: background var(--transition), transform var(--transition);
}
.btn-secondary:hover  { background: rgba(255,255,255,0.15); transform: translateY(-2px); }
.btn-secondary:active { transform: scale(0.97); }

/* Hero indicator dots */
.hero-dots {
  position: absolute;
  bottom: 24px;
  right: 48px;
  display: flex;
  gap: 8px;
  z-index: 3;
}
.hero-dot {
  width: 6px; height: 6px;
  border-radius: 3px;
  background: rgba(255,255,255,0.25);
  border: none;
  cursor: pointer;
  transition: background var(--transition), width var(--transition);
}
.hero-dot.active { width: 24px; background: var(--accent); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SECTIONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.section { padding: 32px 48px; }

.section-header {
  display: flex;
  align-items: baseline;
  justify-content: space-between;
  margin-bottom: 22px;
}

.section-title {
  font-family: 'Bebas Neue', sans-serif;
  font-size: 21px;
  letter-spacing: 2.5px;
  color: var(--text);
}
.section-title span { color: var(--accent); }

.see-all {
  font-size: 11px;
  letter-spacing: 1.5px;
  text-transform: uppercase;
  color: var(--muted);
  background: none;
  border: none;
  transition: color var(--transition);
  padding: 4px 0;
  position: relative;
}
.see-all::after {
  content: 'â†’';
  margin-left: 5px;
  transition: transform var(--transition);
  display: inline-block;
}
.see-all:hover { color: var(--accent); }
.see-all:hover::after { transform: translateX(3px); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TAB BTNS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.tab-btns {
  display: flex;
  gap: 2px;
  border-bottom: 1px solid var(--border);
  margin-bottom: 26px;
}
.tab-btn {
  font-family: 'DM Sans', sans-serif;
  font-size: 12.5px;
  font-weight: 500;
  letter-spacing: 0.5px;
  padding: 10px 20px;
  background: none;
  border: none;
  border-bottom: 2px solid transparent;
  color: var(--muted);
  margin-bottom: -1px;
  transition: color var(--transition), border-color var(--transition);
  white-space: nowrap;
}
.tab-btn:hover  { color: var(--text-dim); }
.tab-btn.active { color: var(--accent); border-bottom-color: var(--accent); }

.tab-content { display: none; }
.tab-content.active { display: block; animation: fadeIn 0.3s ease; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   GENRE CHIPS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.genre-chips {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  margin-bottom: 28px;
}
.genre-chip {
  font-family: 'DM Sans', sans-serif;
  font-size: 12px;
  font-weight: 500;
  letter-spacing: 0.3px;
  padding: 6px 16px;
  border-radius: 99px;
  border: 1px solid var(--border);
  background: transparent;
  color: var(--muted);
  transition: all var(--transition);
}
.genre-chip:hover  { color: var(--text); border-color: var(--border-hi); }
.genre-chip.active { background: var(--accent); color: #000; border-color: var(--accent); font-weight: 600; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MOVIE CARDS GRID
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.cards-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
  gap: 16px;
}

.movie-card {
  border-radius: var(--radius);
  overflow: hidden;
  background: var(--card);
  border: 1px solid var(--border);
  aspect-ratio: 2/3;
  position: relative;
  cursor: pointer;
  transition: transform var(--transition), box-shadow var(--transition), border-color var(--transition);
  will-change: transform;
}
.movie-card:hover {
  transform: translateY(-8px) scale(1.02);
  box-shadow: 0 24px 48px rgba(0,0,0,0.65), 0 0 0 1px rgba(232,201,109,0.2);
  border-color: rgba(232,201,109,0.3);
}

.movie-card img {
  width: 100%; height: 100%;
  object-fit: cover;
  display: block;
  transition: filter 0.4s ease;
}
.movie-card:hover img { filter: brightness(0.75); }

.card-overlay {
  position: absolute;
  inset: 0;
  background: linear-gradient(to top, rgba(7,9,13,0.98) 0%, rgba(7,9,13,0.4) 45%, transparent 70%);
  opacity: 0;
  transition: opacity var(--transition);
  display: flex;
  flex-direction: column;
  justify-content: flex-end;
  padding: 14px;
}
.movie-card:hover .card-overlay { opacity: 1; }

.card-title {
  font-size: 12.5px;
  font-weight: 500;
  line-height: 1.35;
  margin-bottom: 5px;
}
.card-meta {
  font-size: 11px;
  color: var(--muted);
  display: flex;
  gap: 8px;
  align-items: center;
}
.card-rating { color: var(--accent); font-weight: 600; }

.card-play-btn {
  position: absolute;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%) scale(0.7);
  opacity: 0;
  width: 48px; height: 48px;
  background: var(--accent);
  border-radius: 50%;
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all var(--transition);
  box-shadow: 0 4px 20px rgba(232,201,109,0.4);
  pointer-events: none;
}
.card-play-btn svg { fill: #000; width: 18px; height: 18px; margin-left: 2px; }
.movie-card:hover .card-play-btn { opacity: 1; transform: translate(-50%, -50%) scale(1); }

/* Skeleton shimmer */
.skeleton {
  background: linear-gradient(90deg, var(--card) 25%, var(--border) 37%, var(--card) 63%);
  background-size: 400px 100%;
  animation: shimmer 1.4s ease infinite;
}
.no-poster {
  width: 100%; height: 100%;
  background: var(--surface);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 8px;
  font-family: 'Bebas Neue', sans-serif;
  font-size: 13px;
  letter-spacing: 2px;
  color: var(--muted);
  text-align: center;
  padding: 16px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FRANCHISE ROWS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.franchise-block { margin-bottom: 44px; }
.franchise-header {
  display: flex;
  align-items: baseline;
  gap: 12px;
  margin-bottom: 16px;
}
.franchise-name {
  font-family: 'Bebas Neue', sans-serif;
  font-size: 19px;
  letter-spacing: 2px;
}
.franchise-name span { color: var(--accent); }
.franchise-count {
  font-size: 10.5px;
  color: var(--muted);
  letter-spacing: 1.5px;
  text-transform: uppercase;
}

.franchise-row {
  display: flex;
  gap: 13px;
  overflow-x: auto;
  padding-bottom: 8px;
  scrollbar-width: none;
}
.franchise-row::-webkit-scrollbar { display: none; }
.franchise-row .movie-card { flex: 0 0 140px; }

/* Scream row */
#scream-row { display: flex; gap: 13px; overflow-x: auto; padding-bottom: 8px; scrollbar-width: none; }
#scream-row::-webkit-scrollbar { display: none; }
#scream-row .movie-card { flex: 0 0 140px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LOADING / EMPTY STATES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.loading-state {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 64px 24px;
  gap: 10px;
  color: var(--muted);
  font-size: 13px;
  letter-spacing: 0.5px;
}
.spinner {
  width: 20px; height: 20px;
  border: 2px solid var(--border);
  border-top-color: var(--accent);
  border-radius: 50%;
  animation: spin 0.75s linear infinite;
  flex-shrink: 0;
}
.error-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 64px 24px;
  gap: 12px;
  color: var(--muted);
  font-size: 13px;
  text-align: center;
}
.error-state .retry-btn {
  background: none;
  border: 1px solid var(--border);
  color: var(--accent);
  font-family: 'DM Sans', sans-serif;
  font-size: 12px;
  padding: 8px 20px;
  border-radius: var(--radius-sm);
  transition: all var(--transition);
  margin-top: 4px;
}
.error-state .retry-btn:hover { background: var(--surface); border-color: var(--accent); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SEARCH RESULTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#search-results-section { display: none; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PLAYER MODAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.player-modal {
  display: none;
  position: fixed;
  inset: 0;
  z-index: 1000;
  background: rgba(0,0,0,0.92);
  align-items: center;
  justify-content: center;
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
}
.player-modal.active { display: flex; animation: fadeIn 0.2s ease; }

.player-container {
  position: relative;
  width: 90vw;
  max-width: 1200px;
  background: var(--surface);
  border-radius: 14px;
  overflow: hidden;
  border: 1px solid var(--border);
  box-shadow: var(--shadow-lg);
  animation: scaleIn 0.25s cubic-bezier(0.34,1.56,0.64,1);
}

.player-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px 22px;
  background: var(--card);
  border-bottom: 1px solid var(--border);
}
.player-title {
  font-family: 'Bebas Neue', sans-serif;
  font-size: 22px;
  letter-spacing: 2px;
}
.player-subtitle {
  font-size: 11.5px;
  color: var(--muted);
  margin-top: 2px;
}
.player-close {
  background: var(--surface);
  border: 1px solid var(--border);
  color: var(--muted);
  width: 34px; height: 34px;
  border-radius: var(--radius-sm);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
  line-height: 1;
  transition: all var(--transition);
}
.player-close:hover { color: var(--text); background: var(--border); border-color: var(--border-hi); }

.player-wrap {
  position: relative;
  width: 100%;
  padding-bottom: 56.25%;
  background: #000;
}
.player-wrap iframe {
  position: absolute;
  inset: 0;
  width: 100%; height: 100%;
  border: none;
}

/* Source switcher */
.source-switcher {
  display: flex;
  gap: 8px;
  padding: 14px 22px;
  background: var(--card);
  border-top: 1px solid var(--border);
  align-items: center;
  flex-wrap: wrap;
}
.source-label {
  font-size: 10.5px;
  text-transform: uppercase;
  letter-spacing: 1.5px;
  color: var(--muted);
  margin-right: 4px;
  white-space: nowrap;
}
.src-btn {
  font-family: 'DM Sans', sans-serif;
  font-size: 11.5px;
  font-weight: 500;
  padding: 5px 14px;
  border-radius: 4px;
  border: 1px solid var(--border);
  background: none;
  color: var(--muted);
  transition: all var(--transition);
  white-space: nowrap;
}
.src-btn:hover  { color: var(--text); border-color: var(--border-hi); }
.src-btn.active { background: var(--accent); color: #000; border-color: var(--accent); font-weight: 600; }

/* Episode selector */
#episode-selector-wrap { display: none; }
.episode-selector {
  display: flex;
  gap: 12px;
  align-items: center;
  padding: 12px 22px;
  background: var(--card);
  border-top: 1px solid var(--border);
  flex-wrap: wrap;
}
.ep-label {
  font-size: 10.5px;
  text-transform: uppercase;
  letter-spacing: 1.5px;
  color: var(--muted);
}
.ep-select {
  background: var(--surface);
  border: 1px solid var(--border);
  color: var(--text);
  font-family: 'DM Sans', sans-serif;
  font-size: 13px;
  padding: 7px 12px;
  border-radius: 4px;
  outline: none;
  transition: border-color var(--transition);
}
.ep-select:focus { border-color: var(--accent); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FOOTBALL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.football-hero {
  background: 
    linear-gradient(135deg, #080f20 0%, #0c1a38 45%, #07111e 100%);
  border-bottom: 1px solid var(--border);
  padding: 36px 48px 0;
  position: relative;
  overflow: hidden;
}
.football-hero::before {
  content: '';
  position: absolute;
  inset: 0;
  background: radial-gradient(ellipse 70% 80% at 80% 50%, rgba(232,201,109,0.04) 0%, transparent 70%);
  pointer-events: none;
}
.football-hero::after {
  content: 'âš½';
  position: absolute;
  right: 80px; top: 50%;
  transform: translateY(-50%);
  font-size: 130px;
  opacity: 0.04;
  pointer-events: none;
  filter: grayscale(1);
}
.football-hero-title {
  font-family: 'Bebas Neue', sans-serif;
  font-size: 50px;
  letter-spacing: 5px;
  margin-bottom: 5px;
}
.football-hero-sub {
  font-size: 13px;
  color: var(--muted);
  margin-bottom: 22px;
}
.football-controls {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 18px;
  flex-wrap: wrap;
}
.match-search-wrap { position: relative; }
#match-search {
  background: rgba(13,17,23,0.8);
  border: 1px solid var(--border);
  color: var(--text);
  font-family: 'DM Sans', sans-serif;
  font-size: 13px;
  padding: 9px 38px 9px 14px;
  border-radius: var(--radius-sm);
  width: 280px;
  outline: none;
  transition: border-color var(--transition), box-shadow var(--transition);
}
#match-search::placeholder { color: var(--muted); }
#match-search:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(232,201,109,0.08);
}
.refresh-btn {
  background: rgba(13,17,23,0.8);
  border: 1px solid var(--border);
  color: var(--muted);
  font-family: 'DM Sans', sans-serif;
  font-size: 12px;
  padding: 9px 16px;
  border-radius: var(--radius-sm);
  transition: all var(--transition);
  display: flex;
  align-items: center;
  gap: 6px;
}
.refresh-btn:hover { color: var(--text); border-color: var(--border-hi); }
#match-count { font-size: 11.5px; color: var(--muted); margin-left: auto; }

.leagues-bar {
  display: flex;
  gap: 8px;
  overflow-x: auto;
  padding-bottom: 14px;
  scrollbar-width: none;
}
.leagues-bar::-webkit-scrollbar { display: none; }

.league-btn {
  display: flex;
  align-items: center;
  gap: 7px;
  font-family: 'DM Sans', sans-serif;
  font-size: 11.5px;
  font-weight: 500;
  padding: 7px 16px;
  border-radius: var(--radius-sm);
  border: 1px solid var(--border);
  background: rgba(13,17,23,0.5);
  color: var(--muted);
  white-space: nowrap;
  flex-shrink: 0;
  transition: all var(--transition);
}
.league-btn:hover  { color: var(--text); border-color: var(--border-hi); }
.league-btn.active { background: var(--accent); color: #000; border-color: var(--accent); font-weight: 600; }
.league-flag { font-size: 15px; line-height: 1; }

/* Match cards */
.football-section { padding: 28px 48px; }
.matches-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
  gap: 13px;
}

.match-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 20px;
  cursor: pointer;
  transition: transform var(--transition), box-shadow var(--transition), border-color var(--transition);
  position: relative;
  overflow: hidden;
  animation: fadeUp 0.4s ease both;
}
.match-card::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 2px;
  background: linear-gradient(90deg, var(--accent2), var(--accent));
  transform: scaleX(0);
  transform-origin: left;
  transition: transform 0.3s ease;
}
.match-card:hover {
  border-color: rgba(232,201,109,0.3);
  transform: translateY(-3px);
  box-shadow: 0 14px 36px rgba(0,0,0,0.45);
}
.match-card:hover::before { transform: scaleX(1); }

.match-league {
  font-size: 10px;
  font-weight: 600;
  letter-spacing: 1.5px;
  text-transform: uppercase;
  color: var(--muted);
  margin-bottom: 18px;
  display: flex;
  align-items: center;
  gap: 7px;
}
.live-dot {
  width: 6px; height: 6px;
  background: var(--red);
  border-radius: 50%;
  animation: pulse 1.3s ease infinite;
  flex-shrink: 0;
}
.live-badge {
  background: var(--red);
  color: white;
  font-size: 9px;
  font-weight: 700;
  letter-spacing: 1px;
  padding: 2px 7px;
  border-radius: 3px;
}

.match-teams {
  display: flex;
  align-items: center;
  gap: 12px;
}
.match-team {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  text-align: center;
}
.team-badge {
  width: 48px; height: 48px;
  background: var(--surface);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 22px;
  border: 1px solid var(--border);
  overflow: hidden;
  flex-shrink: 0;
}
.team-badge img { width: 32px; height: 32px; object-fit: contain; }
.team-name { font-size: 12.5px; font-weight: 500; line-height: 1.3; }

.match-score-wrap {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 5px;
  min-width: 68px;
}
.vs-text {
  font-family: 'Bebas Neue', sans-serif;
  font-size: 22px;
  letter-spacing: 2px;
  color: var(--muted);
}
.match-time {
  font-size: 10.5px;
  color: var(--muted);
  letter-spacing: 0.5px;
}
.match-time.live { color: var(--red); font-weight: 700; }

.match-footer {
  margin-top: 18px;
  padding-top: 14px;
  border-top: 1px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
}
.stream-count { font-size: 11px; color: var(--muted); }

.watch-btn {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  font-family: 'DM Sans', sans-serif;
  font-size: 11.5px;
  font-weight: 700;
  letter-spacing: 0.3px;
  padding: 7px 18px;
  border-radius: 5px;
  border: none;
  background: var(--accent);
  color: #000;
  transition: all var(--transition);
}
.watch-btn:hover { background: #f5d87a; transform: translateY(-1px); }
.watch-btn:disabled {
  background: var(--border);
  color: var(--muted);
  cursor: not-allowed;
  transform: none;
  opacity: 0.7;
}

.no-matches {
  grid-column: 1/-1;
  text-align: center;
  padding: 64px 24px;
  color: var(--muted);
  font-size: 14px;
  line-height: 1.7;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SETTINGS MODAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.modal-backdrop {
  position: fixed;
  inset: 0;
  z-index: 2000;
  background: rgba(0,0,0,0.8);
  display: none;
  align-items: center;
  justify-content: center;
  backdrop-filter: blur(4px);
}
.modal-backdrop.active { display: flex; animation: fadeIn 0.2s ease; }

.settings-box {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 16px;
  width: 440px;
  max-width: calc(100vw - 32px);
  padding: 0;
  box-shadow: var(--shadow-lg);
  animation: scaleIn 0.25s cubic-bezier(0.34,1.56,0.64,1);
  overflow: hidden;
}
.settings-head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 22px 26px;
  border-bottom: 1px solid var(--border);
}
.settings-head h2 {
  font-family: 'Bebas Neue', sans-serif;
  font-size: 22px;
  letter-spacing: 2.5px;
}
.settings-close {
  background: var(--card);
  border: 1px solid var(--border);
  color: var(--muted);
  width: 32px; height: 32px;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  transition: all var(--transition);
}
.settings-close:hover { color: var(--text); border-color: var(--border-hi); }

.settings-body {
  padding: 22px 26px;
  display: flex;
  flex-direction: column;
  gap: 22px;
}
.settings-row-label {
  font-size: 10.5px;
  text-transform: uppercase;
  letter-spacing: 1.5px;
  color: var(--muted);
  margin-bottom: 10px;
}
.settings-btn-row { display: flex; gap: 8px; flex-wrap: wrap; }

.settings-src-btn {
  font-family: 'DM Sans', sans-serif;
  font-size: 12px;
  font-weight: 500;
  padding: 6px 14px;
  border-radius: 5px;
  border: 1px solid var(--border);
  background: none;
  color: var(--muted);
  transition: all var(--transition);
}
.settings-src-btn:hover { color: var(--text); border-color: var(--border-hi); }
.settings-src-btn.active { background: var(--accent); color: #000; border-color: var(--accent); font-weight: 600; }

.color-btn {
  width: 28px; height: 28px;
  border-radius: 50%;
  border: 3px solid transparent;
  transition: all var(--transition);
  flex-shrink: 0;
}
.color-btn.active { border-color: #fff; transform: scale(1.2); }
.color-btn:hover   { transform: scale(1.1); }

.settings-foot {
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  padding: 18px 26px;
  border-top: 1px solid var(--border);
}
.btn-ghost {
  background: none;
  border: 1px solid var(--border);
  color: var(--muted);
  font-family: 'DM Sans', sans-serif;
  font-size: 13px;
  padding: 9px 20px;
  border-radius: 6px;
  transition: all var(--transition);
}
.btn-ghost:hover { color: var(--text); border-color: var(--border-hi); }
.btn-save {
  background: var(--accent);
  color: #000;
  border: none;
  font-family: 'DM Sans', sans-serif;
  font-size: 13px;
  font-weight: 700;
  padding: 9px 22px;
  border-radius: 6px;
  transition: background var(--transition);
}
.btn-save:hover { background: #f5d87a; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MOBILE BOTTOM NAV
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.mobile-nav {
  display: none;
  position: fixed;
  bottom: 0; left: 0; right: 0;
  z-index: 300;
  height: 62px;
  background: rgba(13,17,23,0.97);
  border-top: 1px solid var(--border);
  backdrop-filter: blur(14px);
  -webkit-backdrop-filter: blur(14px);
}
.mob-btn {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 4px;
  background: none;
  border: none;
  color: var(--muted);
  font-family: 'DM Sans', sans-serif;
  font-size: 9.5px;
  font-weight: 500;
  letter-spacing: 0.5px;
  transition: color var(--transition);
  padding: 0;
}
.mob-btn svg { width: 21px; height: 21px; fill: currentColor; }
.mob-btn.active { color: var(--accent); }
.mob-btn:hover  { color: var(--text-dim); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PERFORMANCE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.tab-content:not(.active) { display: none; }
.franchise-block { content-visibility: auto; contain-intrinsic-size: 0 340px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESPONSIVE â€” TABLET
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@media (max-width: 1024px) {
  .section, .football-section { padding: 28px 32px; }
  .football-hero { padding: 28px 32px 0; }
  .hero { padding: 48px 32px; }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESPONSIVE â€” MOBILE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@media (max-width: 768px) {
  header { padding: 0 16px; gap: 8px; }
  header nav { display: none; }
  #search-input { width: 130px; }
  #search-input:focus { width: 160px; }
  .settings-trigger { display: none; }

  .hero { padding: 28px 16px 36px; height: auto; min-height: 360px; }
  .hero-title { font-size: clamp(36px, 9vw, 52px); }
  .hero-overview { font-size: 13px; -webkit-line-clamp: 2; }
  .hero-actions { gap: 8px; }
  .btn-play, .btn-secondary { padding: 11px 20px; font-size: 12.5px; }
  .hero-dots { right: 16px; }

  .section { padding: 20px 16px; }
  .football-section { padding: 16px; }
  .football-hero { padding: 20px 16px 0; }
  .football-hero-title { font-size: 36px; }
  .football-hero-sub { font-size: 12px; margin-bottom: 14px; }
  #match-search { width: 100%; }
  .football-controls { flex-wrap: wrap; }

  .cards-grid { grid-template-columns: repeat(auto-fill, minmax(110px, 1fr)); gap: 10px; }
  .card-overlay { opacity: 1; }
  .card-play-btn { opacity: 1; transform: translate(-50%, -50%) scale(0.85); }

  .tab-btns { overflow-x: auto; flex-wrap: nowrap; -webkit-overflow-scrolling: touch; scrollbar-width: none; }
  .tab-btns::-webkit-scrollbar { display: none; }
  .tab-btn { font-size: 11.5px; padding: 10px 14px; }

  .genre-chips { overflow-x: auto; flex-wrap: nowrap; -webkit-overflow-scrolling: touch; padding-bottom: 4px; scrollbar-width: none; }
  .genre-chips::-webkit-scrollbar { display: none; }
  .genre-chip { white-space: nowrap; }

  .player-modal { align-items: flex-end; }
  .player-container {
    width: 100vw;
    border-radius: 14px 14px 0 0;
    max-height: 92vh;
    overflow-y: auto;
    animation: slideUp 0.3s cubic-bezier(0.34,1.56,0.64,1);
  }
  .source-switcher { padding: 10px 14px; gap: 6px; }
  .episode-selector { padding: 10px 14px; }

  .matches-grid { grid-template-columns: 1fr; }
  .match-card { padding: 16px; }

  main { padding-bottom: 66px; }
  .mobile-nav { display: flex; }

  .gate-box { padding: 28px 22px; width: calc(100vw - 40px); }
  .gate-logo { font-size: 38px; }
}
</style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PASSWORD GATE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="pw-gate">
  <div class="gate-logo">Reel<span>Wave</span></div>
  <div class="gate-tagline">Private Streaming Platform</div>
  <div class="gate-box">
    <h2>MEMBERS ONLY</h2>
    <p>Enter your password to continue</p>
    <input id="pw-input" type="password" placeholder="Password" autocomplete="current-password">
    <button id="pw-submit">Enter</button>
    <div id="pw-error" role="alert"></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     APP CONTENT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="app-content">

<header>
  <a class="logo" href="#" onclick="return false">Reel<span>Wave</span></a>
  <nav id="main-nav">
    <button class="nav-btn active" data-tab="movies">Movies</button>
    <button class="nav-btn" data-tab="tv">TV Shows</button>
    <button class="nav-btn" data-tab="football">âš½ Football</button>
  </nav>
  <div class="header-right">
    <div class="search-wrap">
      <input type="text" id="search-input" placeholder="Search movies, showsâ€¦" autocomplete="off" spellcheck="false">
      <span class="search-icon" aria-hidden="true">âŒ•</span>
    </div>
    <button class="settings-trigger" id="settings-btn" aria-label="Settings" title="Settings">
      <svg viewBox="0 0 24 24" width="17" height="17" fill="currentColor" aria-hidden="true">
        <path d="M19.14 12.94c.04-.3.06-.61.06-.94s-.02-.64-.07-.94l2.03-1.58a.49.49 0 0 0 .12-.61l-1.92-3.32a.49.49 0 0 0-.59-.22l-2.39.96a7.27 7.27 0 0 0-1.62-.94l-.36-2.54a.484.484 0 0 0-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96a.48.48 0 0 0-.59.22L2.74 8.87a.48.48 0 0 0 .12.61l2.03 1.58c-.05.3-.07.63-.07.94s.02.64.07.94l-2.03 1.58a.49.49 0 0 0-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32a.49.49 0 0 0-.12-.61l-2.03-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/>
      </svg>
    </button>
  </div>
</header>

<!-- SETTINGS MODAL -->
<div class="modal-backdrop" id="settings-modal" role="dialog" aria-modal="true" aria-label="Settings">
  <div class="settings-box">
    <div class="settings-head">
      <h2>SETTINGS</h2>
      <button class="settings-close" id="settings-close" aria-label="Close">âœ•</button>
    </div>
    <div class="settings-body">
      <div>
        <div class="settings-row-label">Default Stream Source</div>
        <div class="settings-btn-row" id="settings-src-btns">
          <button class="settings-src-btn active" data-src="vidsrc">VidSrc</button>
          <button class="settings-src-btn" data-src="vidsrc2">VidSrc 2</button>
          <button class="settings-src-btn" data-src="vidsrccc">VidSrc 3</button>
          <button class="settings-src-btn" data-src="autoembed">AutoEmbed</button>
          <button class="settings-src-btn" data-src="superembed">SuperEmbed</button>
          <button class="settings-src-btn" data-src="vsembed">VSEmbed</button>
          <button class="settings-src-btn" data-src="vidlink">VidLink</button>
        </div>
      </div>
      <div>
        <div class="settings-row-label">Accent Colour</div>
        <div class="settings-btn-row" id="settings-color-btns">
          <button class="color-btn active" data-color="#e8c96d" style="background:#e8c96d" title="Gold"></button>
          <button class="color-btn" data-color="#e84040" style="background:#e84040" title="Red"></button>
          <button class="color-btn" data-color="#4fa3e8" style="background:#4fa3e8" title="Blue"></button>
          <button class="color-btn" data-color="#4de88a" style="background:#4de88a" title="Green"></button>
          <button class="color-btn" data-color="#c06de8" style="background:#c06de8" title="Purple"></button>
          <button class="color-btn" data-color="#e8884d" style="background:#e8884d" title="Orange"></button>
        </div>
      </div>
      <div>
        <div class="settings-row-label">Card Size</div>
        <div class="settings-btn-row" id="settings-size-btns">
          <button class="settings-src-btn" data-size="130">Small</button>
          <button class="settings-src-btn active" data-size="160">Medium</button>
          <button class="settings-src-btn" data-size="200">Large</button>
        </div>
      </div>
    </div>
    <div class="settings-foot">
      <button class="btn-ghost" id="settings-reset">Reset Defaults</button>
      <button class="btn-save" id="settings-save">Save Settings</button>
    </div>
  </div>
</div>

<main>
  <!-- HERO -->
  <section class="hero" id="hero-section">
    <div class="hero-bg" id="hero-bg"></div>
    <div class="hero-vignette"></div>
    <div class="hero-content">
      <span class="hero-badge" id="hero-badge">â­ Featured</span>
      <h1 class="hero-title" id="hero-title">Loadingâ€¦</h1>
      <div class="hero-meta">
        <span class="hero-rating" id="hero-rating">â€”</span>
        <span id="hero-year">â€”</span>
        <span id="hero-genre">â€”</span>
      </div>
      <p class="hero-overview" id="hero-overview"></p>
      <div class="hero-actions">
        <button class="btn-play" id="hero-play">
          <svg viewBox="0 0 24 24" width="15" height="15" fill="currentColor"><path d="M8 5v14l11-7z"/></svg>
          Watch Now
        </button>
        <button class="btn-secondary" id="hero-next">
          <svg viewBox="0 0 24 24" width="15" height="15" fill="currentColor"><path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"/></svg>
          Next
        </button>
      </div>
    </div>
    <div class="hero-dots" id="hero-dots"></div>
  </section>

  <!-- SEARCH RESULTS -->
  <section class="section" id="search-results-section">
    <div class="section-header">
      <h2 class="section-title">SEARCH <span>RESULTS</span></h2>
    </div>
    <div class="cards-grid" id="search-results-grid"></div>
  </section>

  <!-- MOVIES TAB -->
  <div id="movies-tab" class="tab-content active">
    <section class="section">
      <div class="tab-btns">
        <button class="tab-btn active" data-movie-type="popular">Popular</button>
        <button class="tab-btn" data-movie-type="top_rated">Top Rated</button>
        <button class="tab-btn" data-movie-type="now_playing">Now Playing</button>
        <button class="tab-btn" data-movie-type="upcoming">Upcoming</button>
        <button class="tab-btn" data-franchise="true">ğŸ¬ Franchises</button>
      </div>

      <div class="genre-chips" id="movie-genres"></div>

      <!-- Scream spotlight -->
      <div id="scream-section" style="margin-bottom:36px">
        <div class="section-header">
          <h2 class="section-title">ğŸ”ª SCREAM <span>COLLECTION</span></h2>
        </div>
        <div id="scream-row"></div>
      </div>

      <!-- Franchise view -->
      <div id="franchise-view" style="display:none"></div>

      <!-- Main grid -->
      <div id="movies-grid" class="cards-grid">
        <div class="loading-state"><div class="spinner"></div> Loading moviesâ€¦</div>
      </div>
    </section>
  </div>

  <!-- TV TAB -->
  <div id="tv-tab" class="tab-content">
    <section class="section">
      <div class="tab-btns">
        <button class="tab-btn active" data-tv-type="popular">Popular</button>
        <button class="tab-btn" data-tv-type="top_rated">Top Rated</button>
        <button class="tab-btn" data-tv-type="on_the_air">On Air</button>
        <button class="tab-btn" data-tv-type="airing_today">Today</button>
      </div>
      <div id="tv-grid" class="cards-grid">
        <div class="loading-state"><div class="spinner"></div> Loading showsâ€¦</div>
      </div>
    </section>
  </div>

  <!-- FOOTBALL TAB -->
  <div id="football-tab" class="tab-content">
    <div class="football-hero">
      <div class="football-hero-title">LIVE <span style="color:var(--accent)">FOOTBALL</span></div>
      <div class="football-hero-sub">Today's matches, live scores &amp; streams</div>
      <div class="football-controls">
        <div class="match-search-wrap">
          <input type="text" id="match-search" placeholder="Search teams or competitionsâ€¦" autocomplete="off">
          <span class="search-icon" aria-hidden="true" style="position:absolute;right:10px;top:50%;transform:translateY(-50%);color:var(--muted);pointer-events:none;">âŒ•</span>
        </div>
        <button class="refresh-btn" id="football-refresh">
          <svg viewBox="0 0 24 24" width="14" height="14" fill="currentColor"><path d="M17.65 6.35A7.958 7.958 0 0 0 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0 1 12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/></svg>
          Refresh
        </button>
        <span id="match-count"></span>
      </div>
      <div class="leagues-bar" id="leagues-bar">
        <button class="league-btn active" data-league="all"><span class="league-flag">ğŸŒ</span> All</button>
        <button class="league-btn" data-league="epl"><span class="league-flag">ğŸ´ó §ó ¢ó ¥ó ®ó §ó ¿</span> Premier League</button>
        <button class="league-btn" data-league="championship"><span class="league-flag">ğŸ´ó §ó ¢ó ¥ó ®ó §ó ¿</span> Championship</button>
        <button class="league-btn" data-league="league_one"><span class="league-flag">ğŸ´ó §ó ¢ó ¥ó ®ó §ó ¿</span> League One</button>
        <button class="league-btn" data-league="league_two"><span class="league-flag">ğŸ´ó §ó ¢ó ¥ó ®ó §ó ¿</span> League Two</button>
        <button class="league-btn" data-league="scottish"><span class="league-flag">ğŸ´ó §ó ¢ó ³ó £ó ´ó ¿</span> Scottish Prem</button>
        <button class="league-btn" data-league="ucl"><span class="league-flag">â­</span> Champions League</button>
        <button class="league-btn" data-league="laliga"><span class="league-flag">ğŸ‡ªğŸ‡¸</span> La Liga</button>
        <button class="league-btn" data-league="serie_a"><span class="league-flag">ğŸ‡®ğŸ‡¹</span> Serie A</button>
        <button class="league-btn" data-league="bundesliga"><span class="league-flag">ğŸ‡©ğŸ‡ª</span> Bundesliga</button>
        <button class="league-btn" data-league="ligue1"><span class="league-flag">ğŸ‡«ğŸ‡·</span> Ligue 1</button>
      </div>
    </div>
    <div class="football-section">
      <div class="matches-grid" id="matches-grid">
        <div class="loading-state"><div class="spinner"></div> Loading matchesâ€¦</div>
      </div>
    </div>
  </div>
</main>

<!-- PLAYER MODAL -->
<div class="player-modal" id="player-modal" role="dialog" aria-modal="true">
  <div class="player-container">
    <div class="player-header">
      <div>
        <div class="player-title" id="player-title">â€”</div>
        <div class="player-subtitle" id="player-subtitle"></div>
      </div>
      <button class="player-close" id="player-close" aria-label="Close player">âœ•</button>
    </div>
    <div class="player-wrap">
      <iframe id="player-iframe"
        allowfullscreen
        allow="autoplay; fullscreen; encrypted-media; picture-in-picture"
        referrerpolicy="no-referrer"
        title="Video player"></iframe>
    </div>
    <div id="episode-selector-wrap">
      <div class="episode-selector">
        <span class="ep-label">Season</span>
        <select class="ep-select" id="season-select"></select>
        <span class="ep-label">Episode</span>
        <select class="ep-select" id="episode-select"></select>
      </div>
    </div>
    <div class="source-switcher" id="source-switcher">
      <span class="source-label">Source</span>
      <button class="src-btn active" data-src="vidsrc">VidSrc</button>
      <button class="src-btn" data-src="vidsrc2">VidSrc 2</button>
      <button class="src-btn" data-src="vidsrccc">VidSrc 3</button>
      <button class="src-btn" data-src="autoembed">AutoEmbed</button>
      <button class="src-btn" data-src="superembed">SuperEmbed</button>
      <button class="src-btn" data-src="vsembed">VSEmbed</button>
      <button class="src-btn" data-src="vidlink">VidLink</button>
    </div>
  </div>
</div>

</div><!-- #app-content -->

<!-- MOBILE BOTTOM NAV -->
<nav class="mobile-nav" id="mobile-nav" aria-label="Mobile navigation">
  <button class="mob-btn active" data-tab="movies" id="mob-movies">
    <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M18 4l2 4h-3l-2-4h-2l2 4h-3l-2-4H8l2 4H7L5 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4h-4z"/></svg>
    Movies
  </button>
  <button class="mob-btn" data-tab="tv" id="mob-tv">
    <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M21 3H3c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h5v2h8v-2h5c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 14H3V5h18v12z"/></svg>
    TV Shows
  </button>
  <button class="mob-btn" data-tab="football" id="mob-football">
    <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 14.93V15h2v1.93c-.66.07-1.34.07-2 0zm-5.93-3H7v-2H5.07A8.044 8.044 0 0 1 5 12c0-.34.03-.66.07-1H7v-2H5.07C5.56 6.22 7.93 4.26 10.83 4.03l-.01.07H11V6h2V4.1l-.01-.07c2.9.23 5.27 2.19 5.76 4.9H17v2h1.93c.04.34.07.66.07 1 0 .34-.03.66-.07 1H17v2h1.93c-.49 2.71-2.86 4.67-5.76 4.9L13 17.9V16h-2v1.9l-.01.07c-2.9-.23-5.27-2.19-5.76-4.9-.01-.04-.02-.04.84-.04z"/></svg>
    Football
  </button>
  <button class="mob-btn" id="mob-settings">
    <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M19.14 12.94c.04-.3.06-.61.06-.94s-.02-.64-.07-.94l2.03-1.58a.49.49 0 0 0 .12-.61l-1.92-3.32a.49.49 0 0 0-.59-.22l-2.39.96a7.27 7.27 0 0 0-1.62-.94l-.36-2.54a.484.484 0 0 0-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96a.48.48 0 0 0-.59.22L2.74 8.87a.48.48 0 0 0 .12.61l2.03 1.58c-.05.3-.07.63-.07.94s.02.64.07.94l-2.03 1.58a.49.49 0 0 0-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32a.49.49 0 0 0-.12-.61l-2.03-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg>
    Settings
  </button>
</nav>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     JAVASCRIPT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
'use strict';

/* â”€â”€â”€ AD BLOCKING (runs immediately) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
(function adBlock() {
  // 1. Block window.open popups from iframes
  const _open = window.open;
  window.open = function(url, name, features) {
    if (!url || url === '' || url === 'about:blank') return _open.call(this, url, name, features);
    return null;
  };

  // 2. Warn before unload only when player is active
  window.addEventListener('beforeunload', e => {
    const modal = document.getElementById('player-modal');
    if (modal && modal.classList.contains('active')) { e.preventDefault(); e.returnValue = ''; }
  });

  // 3. Block notification permission
  if ('Notification' in window) {
    try {
      Object.defineProperty(Notification, 'requestPermission', {
        value: () => Promise.resolve('denied'), writable: true, configurable: true
      });
    } catch (_) {}
  }

  // 4. Block push subscriptions
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.ready
      .then(reg => { if (reg?.pushManager) reg.pushManager.subscribe = () => Promise.reject(new Error('blocked')); })
      .catch(() => {});
  }

  // 5. Override document.write for ad injection attempts
  const _dw = document.write.bind(document);
  document.write = function(html) {
    const blocked = ['adsense', 'doubleclick', 'popads', 'adsbygoogle', 'googletag'];
    if (typeof html === 'string' && blocked.some(p => html.includes(p))) return;
    _dw(html);
  };

  // 6. Block eval-based popunders
  const _eval = window.eval;
  window.eval = function(code) {
    const blocked = ['popunder', 'clickunder', 'popads', 'popcash', 'trafficjunky'];
    if (typeof code === 'string' && blocked.some(p => code.includes(p))) return undefined;
    return _eval.call(this, code);
  };

  // 7. Helper: safe className for SVG elements
  function safeClass(node) {
    try {
      const c = node.className;
      if (!c) return '';
      return (typeof c === 'string' ? c : (c.baseVal || '')).toLowerCase();
    } catch (_) { return ''; }
  }

  // 8. Ad node detector
  const OWN_IDS = new Set(['player-modal','player-iframe','pw-gate','mobile-nav',
    'settings-modal','app-content','hero-section','scream-row','movies-grid','tv-grid',
    'matches-grid','franchise-view','source-switcher']);
  const AD_TOKENS = ['adsense','advert','adwrap','ad-wrap','ad-banner','leaderboard',
    'interstitial','ad-overlay','adoverlay','sticky-ad','popunder','clickunder','admodal',
    'gpt-ad','div-gpt','google_ads','carbonads','ez-ad'];
  const AD_SRCS = ['doubleclick','googlesyndication','adnxs','adroll','rubiconproject',
    'openx.net','pubmatic','exoclick','trafficjunky','popads','popcash','propellerads',
    'adsterra','adcash','juicyads','yllix','evadav','richpush','coinzilla','a-ads.com'];
  const AD_SCRIPTS = ['adsbygoogle','googletag','popads.net','popcash.net','exoclick',
    'trafficjunky','propellerads','adsterra','coinhive','cryptoloot','minero.cc','webmr.ru'];

  function isAdNode(node) {
    if (!node || node.nodeType !== 1) return false;
    const tag = (node.tagName || '').toLowerCase();
    const id  = (node.id  || '').toLowerCase();
    const cls = safeClass(node);
    const src = node.src || node.href || '';
    if (OWN_IDS.has(node.id) || OWN_IDS.has(id)) return false;
    const zi = parseInt(node.style?.zIndex || 0, 10);
    const pos = node.style?.position;
    if ((pos === 'fixed' || pos === 'absolute') && zi > 9999) return true;
    if (AD_TOKENS.some(t => id.includes(t) || cls.includes(t))) return true;
    if (tag === 'iframe' && node.id !== 'player-iframe' && AD_SRCS.some(s => src.includes(s))) return true;
    if (tag === 'script' && AD_SCRIPTS.some(s => src.includes(s) || (node.textContent || '').includes(s))) return true;
    return false;
  }

  const AD_SELECTORS = ['.adsbygoogle','[id*="google_ads"]','[id*="div-gpt-ad"]',
    '[class*="popunder"]','[class*="clickunder"]'];

  new MutationObserver(muts => {
    muts.forEach(m => {
      m.addedNodes.forEach(n => {
        if (isAdNode(n)) { n.remove(); return; }
        if (n.nodeType === 1) AD_SELECTORS.forEach(s => { try { n.querySelectorAll(s).forEach(e => e.remove()); } catch (_) {} });
      });
      if (m.type === 'attributes' && isAdNode(m.target)) m.target.remove();
    });
  }).observe(document.documentElement, { childList: true, subtree: true, attributes: true, attributeFilter: ['style','class'] });

  function sweep() {
    AD_SELECTORS.forEach(s => {
      try { document.querySelectorAll(s).forEach(e => { if (e.id !== 'player-iframe') e.remove(); }); } catch (_) {}
    });
    try { document.querySelectorAll('div,iframe,ins').forEach(e => { if (isAdNode(e)) e.remove(); }); } catch (_) {}
  }
  [600, 2200, 5000].forEach(t => setTimeout(sweep, t));
  setInterval(sweep, 12000);
})();

/* â”€â”€â”€ CONSTANTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const TMDB_KEY  = '8265bd1679663a7ea12ac168da84d2e8';
const TMDB_BASE = 'https://api.themoviedb.org/3';
const IMG_BASE  = 'https://image.tmdb.org/t/p/';
const STREAMED_API  = 'https://streamed.pk/api';
const STREAMED_BASE = 'https://streamed.su';
const SETTINGS_KEY  = 'cs_settings_v2';

/* â”€â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
let state = {
  currentTab:      'movies',
  currentSource:   'vidsrc',
  currentMedia:    null,
  heroMovies:      [],
  heroIndex:       0,
  heroTimer:       null,
  footballLoaded:  false,
  allMatches:      [],
  leagueFilter:    'all',
  matchQuery:      '',
  franchiseDone:   false,
  settings: { source: 'vidsrc', accent: '#e8c96d', cardSize: 160 },
};

// Safe match data map to avoid inline data attributes
const matchMap = new Map();
let matchCounter = 0;

/* â”€â”€â”€ TMDB FETCH with cache â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const _tmdbCache = new Map();
async function tmdb(path) {
  if (_tmdbCache.has(path)) return _tmdbCache.get(path);
  const sep = path.includes('?') ? '&' : '?';
  const url = `${TMDB_BASE}${path}${sep}api_key=${TMDB_KEY}&language=en-US`;
  const res  = await fetch(url);
  if (!res.ok) throw new Error(`TMDB ${res.status}`);
  const json = await res.json();
  _tmdbCache.set(path, json);
  // Expire cache after 5 minutes
  setTimeout(() => _tmdbCache.delete(path), 300000);
  return json;
}

function posterUrl(path, size = 'w342') {
  return path ? `${IMG_BASE}${size}${path}` : null;
}
function backdropUrl(path) {
  return path ? `${IMG_BASE}w1280${path}` : null;
}

/* â”€â”€â”€ HTML ESCAPE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function esc(s) {
  return String(s ?? '').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
}

/* â”€â”€â”€ FOOTBALL FETCH WITH FALLBACK PROXIES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
async function fetchWithFallback(apiUrl) {
  const attempts = [
    () => fetch(`/api/proxy?url=${encodeURIComponent(apiUrl)}`),
    () => fetch(`https://api.allorigins.win/raw?url=${encodeURIComponent(apiUrl)}`),
    () => fetch(`https://corsproxy.io/?${encodeURIComponent(apiUrl)}`),
    () => fetch(apiUrl),
  ];
  for (const attempt of attempts) {
    try {
      const res = await attempt();
      if (res.ok) return res.json();
    } catch (_) {}
  }
  throw new Error('All proxy attempts failed');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HERO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function loadHero() {
  try {
    const data = await tmdb('/movie/popular?page=1');
    state.heroMovies = data.results.filter(m => m.backdrop_path).slice(0, 8);
    renderHeroDots();
    setHero(0);
    clearInterval(state.heroTimer);
    state.heroTimer = setInterval(() => advanceHero(), 7000);
  } catch (_) {}
}

function renderHeroDots() {
  const wrap = document.getElementById('hero-dots');
  wrap.innerHTML = state.heroMovies.map((_, i) =>
    `<button class="hero-dot${i === 0 ? ' active' : ''}" aria-label="Feature ${i + 1}"></button>`
  ).join('');
  wrap.querySelectorAll('.hero-dot').forEach((dot, i) => {
    dot.addEventListener('click', () => { clearInterval(state.heroTimer); setHero(i); state.heroTimer = setInterval(advanceHero, 7000); });
  });
}

function advanceHero() {
  state.heroIndex = (state.heroIndex + 1) % state.heroMovies.length;
  setHero(state.heroIndex);
}

function setHero(i) {
  state.heroIndex = i;
  const m = state.heroMovies[i];
  if (!m) return;

  const bg = backdropUrl(m.backdrop_path);
  const heroBg = document.getElementById('hero-bg');
  if (bg) {
    heroBg.classList.add('transitioning');
    heroBg.style.backgroundImage = `url(${bg})`;
    setTimeout(() => heroBg.classList.remove('transitioning'), 900);
  }

  document.getElementById('hero-title').textContent    = m.title;
  document.getElementById('hero-rating').textContent   = `â­ ${m.vote_average?.toFixed(1) ?? 'â€”'}`;
  document.getElementById('hero-year').textContent     = (m.release_date || '').slice(0, 4) || 'â€”';
  document.getElementById('hero-overview').textContent = m.overview || '';
  document.getElementById('hero-play').onclick = () => playMovie(m);
  document.getElementById('hero-next').onclick = () => { clearInterval(state.heroTimer); advanceHero(); state.heroTimer = setInterval(advanceHero, 7000); };

  document.querySelectorAll('.hero-dot').forEach((d, idx) => d.classList.toggle('active', idx === i));
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TAB NAVIGATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function showTab(tab) {
  state.currentTab = tab;

  // Toggle tab content
  document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
  document.getElementById(`${tab}-tab`).classList.add('active');

  // Header nav active
  document.querySelectorAll('#main-nav .nav-btn').forEach(btn => btn.classList.toggle('active', btn.dataset.tab === tab));

  // Mobile nav active
  document.querySelectorAll('.mob-btn[data-tab]').forEach(btn => btn.classList.toggle('active', btn.dataset.tab === tab));

  // Hero visibility
  const heroSection = document.getElementById('hero-section');
  heroSection.style.display = tab === 'football' ? 'none' : '';

  // Hide search results
  document.getElementById('search-results-section').style.display = 'none';
  document.getElementById('search-input').value = '';

  // Lazy load football
  if (tab === 'football' && !state.footballLoaded) loadFootball();

  // Lazy load TV
  if (tab === 'tv') {
    const tvGrid = document.getElementById('tv-grid');
    const firstTabBtn = document.querySelector('#tv-tab .tab-btn.active');
    if (tvGrid.querySelector('.loading-state')) {
      fetchTV(firstTabBtn?.dataset.tvType || 'popular');
    }
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MOVIES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function fetchMovies(type) {
  const grid = document.getElementById('movies-grid');
  grid.innerHTML = '<div class="loading-state"><div class="spinner"></div> Loadingâ€¦</div>';
  try {
    const data = await tmdb(`/movie/${type}?page=1`);
    renderGrid(grid, data.results, 'movie');
  } catch (_) {
    grid.innerHTML = `<div class="error-state">âš ï¸ Failed to load movies.<button class="retry-btn" onclick="fetchMovies('${type}')">Try again</button></div>`;
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TV SHOWS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function fetchTV(type) {
  const grid = document.getElementById('tv-grid');
  grid.innerHTML = '<div class="loading-state"><div class="spinner"></div> Loadingâ€¦</div>';
  try {
    const data = await tmdb(`/tv/${type}?page=1`);
    renderGrid(grid, data.results, 'tv');
  } catch (_) {
    grid.innerHTML = `<div class="error-state">âš ï¸ Failed to load shows.<button class="retry-btn" onclick="fetchTV('${type}')">Try again</button></div>`;
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RENDER GRID
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderGrid(grid, items, type) {
  grid.innerHTML = '';
  if (!items.length) {
    grid.innerHTML = '<div class="error-state">No results found.</div>';
    return;
  }
  const fragment = document.createDocumentFragment();
  items.forEach((item, idx) => {
    const card = makeCard(item, type, idx);
    fragment.appendChild(card);
  });
  grid.appendChild(fragment);
}

function makeCard(item, type, delay = 0) {
  const title = item.title || item.name || 'Untitled';
  const year  = (item.release_date || item.first_air_date || '').slice(0, 4);
  const img   = posterUrl(item.poster_path);
  const rating = item.vote_average?.toFixed(1) ?? 'â€”';

  const card = document.createElement('div');
  card.className = 'movie-card';
  card.style.animationDelay = `${delay * 30}ms`;
  card.style.animation = `fadeUp 0.4s ease ${delay * 30}ms both`;

  if (img) {
    const imgEl = document.createElement('img');
    imgEl.src = img;
    imgEl.alt = esc(title);
    imgEl.loading = 'lazy';
    imgEl.decoding = 'async';
    card.appendChild(imgEl);
  } else {
    const np = document.createElement('div');
    np.className = 'no-poster';
    np.textContent = title;
    card.appendChild(np);
  }

  card.innerHTML += `
    <div class="card-overlay">
      <div class="card-title">${esc(title)}</div>
      <div class="card-meta">
        <span class="card-rating">â­ ${esc(rating)}</span>
        <span>${esc(year)}</span>
        ${type === 'tv' ? `<span style="color:var(--accent2);font-size:10px">TV</span>` : ''}
      </div>
    </div>
    <button class="card-play-btn" aria-label="Play ${esc(title)}">
      <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
    </button>`;

  card.addEventListener('click', () => type === 'movie' ? playMovie(item) : playTV(item));
  return card;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PLAYER â€” MOVIE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function playMovie(movie) {
  state.currentMedia = { type: 'movie', id: movie.id, title: movie.title || 'Unknown' };
  document.getElementById('player-title').textContent    = movie.title || 'Unknown';
  document.getElementById('player-subtitle').textContent = (movie.release_date || '').slice(0, 4);
  document.getElementById('episode-selector-wrap').style.display = 'none';
  resetSourceSwitcher();
  setPlayerSrc();
  openPlayer();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PLAYER â€” TV
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function playTV(show) {
  state.currentMedia = { type: 'tv', id: show.id, title: show.name || 'Unknown', season: 1, episode: 1 };
  document.getElementById('player-title').textContent    = show.name || 'Unknown';
  document.getElementById('player-subtitle').textContent = 'Loading episode dataâ€¦';
  document.getElementById('episode-selector-wrap').style.display = 'block';
  document.getElementById('player-iframe').src = '';
  resetSourceSwitcher();
  openPlayer();

  try {
    const details = await tmdb(`/tv/${show.id}`);
    const seasons = (details.seasons || []).filter(s => s.season_number > 0);
    if (!seasons.length) throw new Error('No seasons');

    const seasonSel = document.getElementById('season-select');
    seasonSel.innerHTML = seasons.map(s => `<option value="${s.season_number}">${esc(s.name)}</option>`).join('');
    state.currentMedia.season = seasons[0].season_number;
    await loadEpisodes();
  } catch (_) {
    document.getElementById('player-subtitle').textContent = 'Episode data unavailable.';
    setPlayerSrc();
  }
}

async function loadEpisodes() {
  const season = parseInt(document.getElementById('season-select').value, 10);
  state.currentMedia.season = season;
  try {
    const data  = await tmdb(`/tv/${state.currentMedia.id}/season/${season}`);
    const epSel = document.getElementById('episode-select');
    epSel.innerHTML = (data.episodes || []).map(e =>
      `<option value="${e.episode_number}">Ep ${e.episode_number}: ${esc(e.name)}</option>`
    ).join('');
    state.currentMedia.episode = 1;
    setEpisode();
  } catch (_) {
    setPlayerSrc();
  }
}

function setEpisode() {
  state.currentMedia.episode = parseInt(document.getElementById('episode-select').value, 10);
  document.getElementById('player-subtitle').textContent =
    `Season ${state.currentMedia.season} Â· Episode ${state.currentMedia.episode}`;
  setPlayerSrc();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PLAYER SRC
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function setPlayerSrc() {
  const m = state.currentMedia;
  if (!m || m.type === 'football') return;
  const { type, id, season, episode } = m;
  let url = '';

  switch (state.currentSource) {
    case 'vidsrc':
      url = type === 'movie'
        ? `https://vidsrc.cc/v2/embed/movie/${id}`
        : `https://vidsrc.cc/v2/embed/tv/${id}/${season}/${episode}`;
      break;
    case 'vidsrc2':
      url = type === 'movie'
        ? `https://vidsrc.to/embed/movie/${id}`
        : `https://vidsrc.to/embed/tv/${id}/${season}/${episode}`;
      break;
    case 'vidsrccc':
      url = type === 'movie'
        ? `https://vidsrc.me/embed/movie?tmdb=${id}`
        : `https://vidsrc.me/embed/tv?tmdb=${id}&season=${season}&episode=${episode}`;
      break;
    case 'autoembed':
      url = type === 'movie'
        ? `https://player.autoembed.cc/embed/movie/${id}`
        : `https://player.autoembed.cc/embed/tv/${id}/${season}/${episode}`;
      break;
    case 'superembed':
      url = type === 'movie'
        ? `https://multiembed.mov/?video_id=${id}&tmdb=1`
        : `https://multiembed.mov/?video_id=${id}&tmdb=1&s=${season}&e=${episode}`;
      break;
    case 'vsembed':
      url = type === 'movie'
        ? `https://embed.su/embed/movie/${id}`
        : `https://embed.su/embed/tv/${id}/${season}/${episode}`;
      break;
    case 'vidlink':
      url = type === 'movie'
        ? `https://vidlink.pro/movie/${id}`
        : `https://vidlink.pro/tv/${id}/${season}/${episode}`;
      break;
  }

  document.getElementById('player-iframe').src = url;
}

function resetSourceSwitcher() {
  const switcher = document.getElementById('source-switcher');
  switcher.innerHTML = '<span class="source-label">Source</span>';
  const sources = [
    { key: 'vidsrc',    label: 'VidSrc'    },
    { key: 'vidsrc2',   label: 'VidSrc 2'  },
    { key: 'vidsrccc',  label: 'VidSrc 3'  },
    { key: 'autoembed', label: 'AutoEmbed' },
    { key: 'superembed',label: 'SuperEmbed'},
    { key: 'vsembed',   label: 'VSEmbed'   },
    { key: 'vidlink',   label: 'VidLink'   },
  ];
  sources.forEach(({ key, label }) => {
    const btn = document.createElement('button');
    btn.className = `src-btn${key === state.currentSource ? ' active' : ''}`;
    btn.textContent = label;
    btn.dataset.src = key;
    btn.addEventListener('click', () => switchSource(key));
    switcher.appendChild(btn);
  });
}

function switchSource(src) {
  state.currentSource = src;
  document.querySelectorAll('#source-switcher .src-btn').forEach(b => b.classList.toggle('active', b.dataset.src === src));
  if (state.currentMedia && state.currentMedia.type !== 'football') setPlayerSrc();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PLAYER OPEN / CLOSE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function openPlayer() {
  document.getElementById('player-modal').classList.add('active');
  document.body.style.overflow = 'hidden';
}

function closePlayer() {
  document.getElementById('player-modal').classList.remove('active');
  document.getElementById('player-iframe').src = '';
  document.body.style.overflow = '';
  state.currentMedia = null;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SEARCH
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let searchTimer;
document.getElementById('search-input').addEventListener('input', e => {
  clearTimeout(searchTimer);
  const q = e.target.value.trim();
  if (!q) {
    document.getElementById('search-results-section').style.display = 'none';
    if (state.currentTab !== 'football') document.getElementById('hero-section').style.display = '';
    return;
  }
  document.getElementById('hero-section').style.display = 'none';
  document.getElementById('search-results-section').style.display = 'block';
  const grid = document.getElementById('search-results-grid');
  grid.innerHTML = '<div class="loading-state"><div class="spinner"></div> Searchingâ€¦</div>';
  searchTimer = setTimeout(() => doSearch(q), 380);
});

async function doSearch(q) {
  const grid = document.getElementById('search-results-grid');
  try {
    const data  = await tmdb(`/search/multi?query=${encodeURIComponent(q)}&page=1`);
    const items = data.results.filter(r => r.media_type === 'movie' || r.media_type === 'tv');
    if (!items.length) { grid.innerHTML = '<div class="error-state">No results found.</div>'; return; }
    renderGrid(grid, items, 'mixed');
    // Override click for mixed type
    grid.querySelectorAll('.movie-card').forEach((card, i) => {
      const item = items[i];
      if (!item) return;
      card.replaceWith(makeCard(item, item.media_type));
    });
    // Re-render properly
    renderGrid(grid, items.map(i => i), 'mixed');
    grid.innerHTML = '';
    const frag = document.createDocumentFragment();
    items.forEach((item, idx) => {
      frag.appendChild(makeCard(item, item.media_type, idx));
    });
    grid.appendChild(frag);
  } catch (_) {
    grid.innerHTML = '<div class="error-state">âš ï¸ Search failed. Please try again.</div>';
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   GENRES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function loadGenres() {
  try {
    const data = await tmdb('/genre/movie/list');
    const wrap = document.getElementById('movie-genres');
    data.genres.slice(0, 14).forEach(g => {
      const chip = document.createElement('button');
      chip.className = 'genre-chip';
      chip.textContent = g.name;
      chip.addEventListener('click', () => {
        document.querySelectorAll('.genre-chip').forEach(c => c.classList.remove('active'));
        chip.classList.add('active');
        // Hide franchise view, show main grid
        document.getElementById('franchise-view').style.display = 'none';
        document.getElementById('movies-grid').style.display = '';
        document.getElementById('scream-section').style.display = '';
        fetchByGenre(g.id);
      });
      wrap.appendChild(chip);
    });
  } catch (_) {}
}

async function fetchByGenre(id) {
  const grid = document.getElementById('movies-grid');
  grid.innerHTML = '<div class="loading-state"><div class="spinner"></div> Loadingâ€¦</div>';
  try {
    const data = await tmdb(`/discover/movie?with_genres=${id}&sort_by=popularity.desc&page=1`);
    renderGrid(grid, data.results, 'movie');
  } catch (_) {
    grid.innerHTML = '<div class="error-state">âš ï¸ Failed to load genre.</div>';
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCREAM COLLECTION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const SCREAM_IDS = [
  { id: 4232,    title: 'Scream',    year: '1996' },
  { id: 4233,    title: 'Scream 2',  year: '1997' },
  { id: 4234,    title: 'Scream 3',  year: '2000' },
  { id: 41446,   title: 'Scream 4',  year: '2011' },
  { id: 646385,  title: 'Scream',    year: '2022' },
  { id: 934433,  title: 'Scream VI', year: '2023' },
  { id: 1159559, title: 'Scream VII',year: '2026' },
];

function loadScreamRow() {
  const row = document.getElementById('scream-row');
  row.className = 'franchise-row';

  // Insert skeleton placeholders
  row.innerHTML = SCREAM_IDS.map(() =>
    `<div class="movie-card skeleton" style="flex:0 0 140px;aspect-ratio:2/3"></div>`
  ).join('');

  SCREAM_IDS.forEach((entry, idx) => {
    tmdb(`/movie/${entry.id}`)
      .then(movie => {
        const card = makeCard(movie, 'movie', idx);
        card.style.cssText = 'flex:0 0 140px;aspect-ratio:2/3';
        row.children[idx]?.replaceWith(card);
      })
      .catch(() => {
        const card = makeCard({ id: entry.id, title: entry.title, release_date: entry.year }, 'movie', idx);
        card.style.cssText = 'flex:0 0 140px;aspect-ratio:2/3';
        row.children[idx]?.replaceWith(card);
      });
  });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FRANCHISES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const FRANCHISES = [
  { label: 'SCREAM', accent: 'FRANCHISE', ids: SCREAM_IDS },
  { label: 'SPIDER-MAN', accent: 'FILMS', ids: [
    { id: 557,    title: 'Spider-Man',              year: '2002' },
    { id: 558,    title: 'Spider-Man 2',             year: '2004' },
    { id: 559,    title: 'Spider-Man 3',             year: '2007' },
    { id: 1930,   title: 'The Amazing Spider-Man',   year: '2012' },
    { id: 102382, title: 'The Amazing Spider-Man 2', year: '2014' },
    { id: 315635, title: 'Homecoming',               year: '2017' },
    { id: 429617, title: 'Far From Home',            year: '2019' },
    { id: 634649, title: 'No Way Home',              year: '2021' },
  ]},
  { label: 'HALLOWEEN', accent: 'FRANCHISE', ids: [
    { id: 948,    title: 'Halloween',               year: '1978' },
    { id: 8195,   title: 'Halloween II',             year: '1981' },
    { id: 8207,   title: 'Halloween 4',              year: '1988' },
    { id: 8208,   title: 'Halloween 5',              year: '1989' },
    { id: 458156, title: 'Halloween (2018)',          year: '2018' },
    { id: 610253, title: 'Halloween Kills',          year: '2021' },
    { id: 636952, title: 'Halloween Ends',           year: '2022' },
  ]},
  { label: 'FAST & FURIOUS', accent: 'SERIES', ids: [
    { id: 9799,   title: 'The Fast and the Furious', year: '2001' },
    { id: 584,    title: '2 Fast 2 Furious',         year: '2003' },
    { id: 9615,   title: 'Tokyo Drift',              year: '2006' },
    { id: 13804,  title: 'Fast & Furious',           year: '2009' },
    { id: 51497,  title: 'Fast Five',                year: '2011' },
    { id: 82703,  title: 'Fast & Furious 6',         year: '2013' },
    { id: 168259, title: 'Furious 7',                year: '2015' },
    { id: 384018, title: 'F9',                       year: '2021' },
    { id: 385687, title: 'Fast X',                   year: '2023' },
  ]},
  { label: 'SAW', accent: 'FRANCHISE', ids: [
    { id: 176,    title: 'Saw',    year: '2004' },
    { id: 177,    title: 'Saw II', year: '2005' },
    { id: 178,    title: 'Saw III',year: '2006' },
    { id: 287903, title: 'Jigsaw', year: '2017' },
    { id: 593643, title: 'Spiral', year: '2021' },
    { id: 760741, title: 'Saw X',  year: '2023' },
  ]},
  { label: 'HARRY POTTER', accent: 'COLLECTION', ids: [
    { id: 671,   title: "Philosopher's Stone", year: '2001' },
    { id: 672,   title: 'Chamber of Secrets',  year: '2002' },
    { id: 673,   title: 'Prisoner of Azkaban', year: '2004' },
    { id: 674,   title: 'Goblet of Fire',      year: '2005' },
    { id: 675,   title: 'Order of the Phoenix',year: '2007' },
    { id: 767,   title: 'Half-Blood Prince',   year: '2009' },
    { id: 12444, title: 'Deathly Hallows Pt 1',year: '2010' },
    { id: 12445, title: 'Deathly Hallows Pt 2',year: '2011' },
  ]},
];

function showFranchises() {
  document.getElementById('movies-grid').style.display = 'none';
  document.getElementById('movie-genres').style.display = 'none';
  document.getElementById('scream-section').style.display = 'none';
  const fv = document.getElementById('franchise-view');
  fv.style.display = 'block';
  if (state.franchiseDone) return;
  state.franchiseDone = true;

  const frag = document.createDocumentFragment();
  FRANCHISES.forEach(f => {
    const rowId = `fr-${f.label.replace(/\W+/g, '')}`;
    const block = document.createElement('div');
    block.className = 'franchise-block';
    block.innerHTML = `
      <div class="franchise-header">
        <div class="franchise-name">${esc(f.label)} <span>${esc(f.accent)}</span></div>
        <div class="franchise-count">${f.ids.length} FILMS</div>
      </div>
      <div class="franchise-row" id="${rowId}"></div>`;
    frag.appendChild(block);
  });
  fv.appendChild(frag);

  FRANCHISES.forEach(f => {
    const rowId = `fr-${f.label.replace(/\W+/g, '')}`;
    const row = document.getElementById(rowId);
    row.innerHTML = f.ids.map(() =>
      `<div class="movie-card skeleton" style="flex:0 0 140px;aspect-ratio:2/3"></div>`
    ).join('');
    f.ids.forEach((entry, idx) => {
      tmdb(`/movie/${entry.id}`)
        .then(movie => {
          const card = makeCard(movie, 'movie', idx);
          card.style.cssText = 'flex:0 0 140px;aspect-ratio:2/3';
          row.children[idx]?.replaceWith(card);
        })
        .catch(() => {
          const card = makeCard({ id: entry.id, title: entry.title, release_date: entry.year }, 'movie', idx);
          card.style.cssText = 'flex:0 0 140px;aspect-ratio:2/3';
          row.children[idx]?.replaceWith(card);
        });
    });
  });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FOOTBALL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const LEAGUE_TEAMS = {
  epl:          ['liverpool','arsenal','chelsea','manchester united','man united','manchester city','man city','tottenham','spurs','newcastle','aston villa','west ham','everton','brighton','brentford','fulham','wolves','wolverhampton','crystal palace','nottingham forest','leicester','ipswich','southampton','bournemouth'],
  championship: ['derby','blackburn','norwich','swansea','charlton','wrexham','sheffield wednesday','coventry','stoke','burnley','oxford united','west brom','qpr','sheffield utd','sheffield united','millwall','preston','wigan','huddersfield','cardiff','wycombe','burton albion','rotherham','plymouth','reading','bradford','luton','bristol city','watford','middlesbrough','leeds','hull','sunderland','blackpool','lincoln'],
  league_one:   ['bolton','exeter city','portsmouth','hull city','shrewsbury','walsall','cambridge united','milton keynes','swindon','bristol rovers','northampton','peterborough','leyton orient','barnsley','mansfield','afc wimbledon'],
  league_two:   ['oldham','crawley','notts county','grimsby','crewe','tranmere','bromley','accrington','colchester','salford','barnet','chesterfield','barrow','gillingham','fleetwood','newport','stevenage','stockport'],
  ucl:          ['champions league','liverpool','arsenal','chelsea','manchester city','atletico','real madrid','barcelona','psg','paris saint-germain','juventus','inter','milan','porto','benfica','ajax','lyon','dortmund','bayern','leverkusen','celtic','rangers','fiorentina','fenerbahce','stuttgart','lille','nottingham forest'],
  laliga:       ['barcelona','real madrid','atletico','atlÃ©tico','sevilla','real betis','villarreal','rayo vallecano','athletic club','levante','alaves','alavÃ©s','mallorca','real sociedad','osasuna','valencia','girona','getafe','zaragoza','burgos','elche','espanyol'],
  serie_a:      ['inter milan','juventus','napoli','ac milan','atalanta','lazio','roma','as roma','fiorentina','torino','udinese','hellas verona','sassuolo','empoli','parma','cagliari','monza','genoa','como','lecce'],
  bundesliga:   ['borussia dortmund','dortmund','bvb','bayern munich','bayer leverkusen','eintracht frankfurt','freiburg','hoffenheim','st. pauli','werder bremen','heidenheim','mainz','union berlin','mÃ¶nchengladbach','gladbach','wolfsburg','augsburg','bochum'],
  scottish:     ['hearts','aberdeen','falkirk','kilmarnock','motherwell','dundee utd','dundee united','livingston','st mirren','hibernian','celtic','rangers','st johnstone','ross county'],
  ligue1:       ['paris saint-germain','psg','le havre','marseille','lyon','monaco','as monaco','rennes','toulouse','lille','nice','paris fc','lorient','auxerre','metz','brest','nantes','strasbourg','lens','montpellier','reims','angers'],
};

function matchesLeague(title, teams) {
  const t = title.toLowerCase();
  return teams.some(team => t.includes(team));
}

async function loadFootball() {
  state.footballLoaded = true;
  const grid = document.getElementById('matches-grid');
  grid.innerHTML = '<div class="loading-state"><div class="spinner"></div> Fetching matchesâ€¦</div>';

  const endpoints = [
    `${STREAMED_API}/matches/football`,
    `${STREAMED_API}/matches/all`,
  ];

  let matches = null;
  for (const url of endpoints) {
    try {
      const data = await fetchWithFallback(url);
      if (Array.isArray(data) && data.length) { matches = data; break; }
    } catch (_) {}
  }

  if (matches?.length) {
    state.allMatches = matches;
    applyMatchFilters();
  } else {
    state.footballLoaded = false;
    grid.innerHTML = `
      <div class="no-matches">
        âš ï¸ Could not load matches right now.<br>
        <small style="color:var(--muted)">The API may be temporarily unavailable.</small><br>
        <button class="retry-btn" onclick="state.footballLoaded=false;loadFootball()" style="margin-top:12px">Try Again</button>
      </div>`;
  }
}

function applyMatchFilters() {
  let filtered = state.allMatches.filter(m => !m.category || m.category === 'football');

  if (state.leagueFilter !== 'all') {
    const teams = LEAGUE_TEAMS[state.leagueFilter] || [];
    filtered = filtered.filter(m => matchesLeague(m.title || '', teams));
  }

  if (state.matchQuery) {
    const q = state.matchQuery;
    filtered = filtered.filter(m => {
      const hay = [m.title, m.teams?.home?.name, m.teams?.away?.name, m.category, m.competition]
        .filter(Boolean).join(' ').toLowerCase();
      return hay.includes(q);
    });
  }

  filtered.sort((a, b) => {
    const aLive = a.popular || a.status === 'live' ? 1 : 0;
    const bLive = b.popular || b.status === 'live' ? 1 : 0;
    if (bLive !== aLive) return bLive - aLive;
    return (a.date || 0) - (b.date || 0);
  });

  const countEl = document.getElementById('match-count');
  if (countEl) countEl.textContent = `${filtered.length} match${filtered.length !== 1 ? 'es' : ''}`;

  renderMatches(filtered);
}

function getTeamEmoji(name) {
  if (!name) return 'âš½';
  const n = name.toLowerCase();
  if (n.includes('arsenal'))                                     return 'ğŸ”´';
  if (n.includes('chelsea'))                                     return 'ğŸ”µ';
  if (n.includes('man city') || n.includes('manchester city'))  return 'ğŸ©µ';
  if (n.includes('man united') || n.includes('manchester united')) return 'ğŸ”´';
  if (n.includes('liverpool'))                                   return 'â¤ï¸';
  if (n.includes('tottenham') || n.includes('spurs'))           return 'âšª';
  if (n.includes('newcastle'))                                   return 'âš«';
  if (n.includes('aston villa'))                                 return 'ğŸ’œ';
  if (n.includes('west ham'))                                    return 'ğŸŸ£';
  if (n.includes('everton'))                                     return 'ğŸ”µ';
  if (n.includes('brighton'))                                    return 'ğŸ”µ';
  if (n.includes('brentford'))                                   return 'ğŸ”´';
  if (n.includes('fulham'))                                      return 'âšª';
  if (n.includes('wolves') || n.includes('wolverhampton'))      return 'ğŸŸ¡';
  if (n.includes('crystal palace'))                              return 'ğŸ”´';
  if (n.includes('nottingham'))                                  return 'ğŸ”´';
  if (n.includes('leicester'))                                   return 'ğŸ”µ';
  if (n.includes('southampton'))                                 return 'ğŸ”´';
  if (n.includes('sunderland'))                                  return 'ğŸ”´';
  if (n.includes('leeds'))                                       return 'âšª';
  if (n.includes('burnley'))                                     return 'ğŸ”µ';
  if (n.includes('real madrid'))                                 return 'âšª';
  if (n.includes('barcelona'))                                   return 'ğŸ”µ';
  if (n.includes('atletico'))                                    return 'â¤ï¸';
  if (n.includes('bayern'))                                      return 'ğŸ”´';
  if (n.includes('dortmund'))                                    return 'ğŸŸ¡';
  if (n.includes('juventus'))                                    return 'âš«';
  if (n.includes('inter'))                                       return 'ğŸ”µ';
  if (n.includes('ac milan') || n.includes(' milan'))           return 'ğŸ”´';
  if (n.includes('psg') || n.includes('paris'))                 return 'ğŸ”µ';
  if (n.includes('marseille'))                                   return 'âšª';
  if (n.includes('celtic'))                                      return 'ğŸŸ¢';
  if (n.includes('rangers'))                                     return 'ğŸ”µ';
  if (n.includes('england'))                                     return 'ğŸ´ó §ó ¢ó ¥ó ®ó §ó ¿';
  if (n.includes('france'))                                      return 'ğŸ‡«ğŸ‡·';
  if (n.includes('germany'))                                     return 'ğŸ‡©ğŸ‡ª';
  if (n.includes('spain'))                                       return 'ğŸ‡ªğŸ‡¸';
  if (n.includes('brazil'))                                      return 'ğŸ‡§ğŸ‡·';
  if (n.includes('argentina'))                                   return 'ğŸ‡¦ğŸ‡·';
  if (n.includes('portugal'))                                    return 'ğŸ‡µğŸ‡¹';
  if (n.includes('italy'))                                       return 'ğŸ‡®ğŸ‡¹';
  return 'âš½';
}

function extractTeam(title, which) {
  if (!title) return null;
  const sep = /\s+(?:vs?\.?)\s+/i;
  const parts = title.split(sep);
  if (parts.length < 2) return null;
  return which === 'home' ? parts[0].trim() : parts[parts.length - 1].trim();
}

function renderMatches(matches) {
  const grid = document.getElementById('matches-grid');
  grid.innerHTML = '';
  matchMap.clear();
  matchCounter = 0;

  if (!matches?.length) {
    grid.innerHTML = '<div class="no-matches">No matches found right now. Check back later!</div>';
    return;
  }

  const frag = document.createDocumentFragment();

  matches.forEach((m, idx) => {
    const home      = m.teams?.home?.name || m.home || extractTeam(m.title, 'home') || 'â€”';
    const away      = m.teams?.away?.name || m.away || extractTeam(m.title, 'away') || 'â€”';
    const title     = m.title || `${home} vs ${away}`;
    const league    = m.category || m.competition || 'Football';
    const isLive    = m.popular === true || m.status === 'live' || m.live === true;
    const hasSrc    = Array.isArray(m.sources) && m.sources.length > 0;

    // Build badge HTML safely
    const homeBadge = m.teams?.home?.badge
      ? `<img src="${STREAMED_API}/images/badge/${esc(m.teams.home.badge)}.webp" alt="${esc(home)}" onerror="this.style.display='none';this.nextElementSibling.style.display='flex'">`
        + `<span style="display:none">${getTeamEmoji(home)}</span>`
      : getTeamEmoji(home);
    const awayBadge = m.teams?.away?.badge
      ? `<img src="${STREAMED_API}/images/badge/${esc(m.teams.away.badge)}.webp" alt="${esc(away)}" onerror="this.style.display='none';this.nextElementSibling.style.display='flex'">`
        + `<span style="display:none">${getTeamEmoji(away)}</span>`
      : getTeamEmoji(away);

    let kickoffStr = '';
    if (m.date) {
      try {
        const ts = m.date > 1e10 ? m.date : m.date * 1000;
        kickoffStr = new Date(ts).toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit' });
      } catch (_) {}
    }

    const mapKey = ++matchCounter;
    matchMap.set(mapKey, m);

    const card = document.createElement('div');
    card.className = 'match-card';
    card.style.animationDelay = `${idx * 25}ms`;
    card.innerHTML = `
      <div class="match-league">
        ${isLive ? '<div class="live-dot"></div>' : ''}
        ${esc(league)}
        ${isLive ? '<span class="live-badge">LIVE</span>' : ''}
        ${!hasSrc ? '<span style="font-size:10px;color:var(--muted)"> Â· No streams</span>' : ''}
      </div>
      <div class="match-teams">
        <div class="match-team">
          <div class="team-badge">${homeBadge}</div>
          <div class="team-name">${esc(home)}</div>
        </div>
        <div class="match-score-wrap">
          <div class="vs-text">VS</div>
          <div class="match-time ${isLive ? 'live' : ''}">
            ${isLive ? 'â— LIVE' : kickoffStr ? `KO ${kickoffStr}` : 'Soon'}
          </div>
        </div>
        <div class="match-team">
          <div class="team-badge">${awayBadge}</div>
          <div class="team-name">${esc(away)}</div>
        </div>
      </div>
      <div class="match-footer">
        <span class="stream-count">${hasSrc ? `${m.sources.length} stream${m.sources.length !== 1 ? 's' : ''}` : ''}</span>
        <button class="watch-btn" ${!hasSrc ? 'disabled' : ''} data-key="${mapKey}">
          <svg viewBox="0 0 24 24" width="11" height="11" fill="currentColor"><path d="M8 5v14l11-7z"/></svg>
          ${hasSrc ? (isLive ? 'Watch Live' : 'Watch') : 'No Stream'}
        </button>
      </div>`;

    if (hasSrc) {
      card.querySelector('.watch-btn').addEventListener('click', e => {
        e.stopPropagation();
        watchMatch(matchMap.get(parseInt(e.currentTarget.dataset.key, 10)));
      });
    }

    frag.appendChild(card);
  });

  grid.appendChild(frag);
}

async function watchMatch(match) {
  const home   = match.teams?.home?.name || match.home || extractTeam(match.title, 'home') || '?';
  const away   = match.teams?.away?.name || match.away || extractTeam(match.title, 'away') || '?';
  const title  = match.title || `${home} vs ${away}`;
  const league = match.category || 'Football';

  document.getElementById('player-title').textContent    = title;
  document.getElementById('player-subtitle').textContent = `${league}${match.live ? ' Â· LIVE' : ''}`;
  document.getElementById('episode-selector-wrap').style.display = 'none';
  state.currentMedia = { type: 'football', title, streams: [] };
  openPlayer();
  document.getElementById('player-iframe').src = '';

  const switcher = document.getElementById('source-switcher');
  switcher.innerHTML = '<span class="source-label">Stream</span><span style="font-size:12px;color:var(--muted)"><span class="spinner" style="width:13px;height:13px;display:inline-block;vertical-align:middle;margin-right:6px"></span>Loading streamsâ€¦</span>';

  const sources = match.sources || [];
  if (!sources.length) {
    switcher.innerHTML = '<span class="source-label">Stream</span><span style="font-size:12px;color:var(--muted)">No streams available</span>';
    return;
  }

  const results = await Promise.allSettled(
    sources.map(async s => {
      const data = await fetchWithFallback(`${STREAMED_API}/stream/${s.source}/${s.id}`);
      return { source: s, streams: data };
    })
  );

  switcher.innerHTML = '<span class="source-label">Stream</span>';
  let streamIdx = 0;
  let firstLoaded = false;

  results.forEach(result => {
    if (result.status !== 'fulfilled') return;
    const { streams } = result.value;
    const list = Array.isArray(streams) ? streams : [streams];
    list.forEach(stream => {
      if (!stream) return;
      const url = stream.embedUrl || stream.url;
      if (!url) return;
      streamIdx++;
      const label = stream.hd ? `HD ${streamIdx}` : `SD ${streamIdx}`;
      const idx   = state.currentMedia.streams.length;
      state.currentMedia.streams.push(url);

      const btn = document.createElement('button');
      btn.className = `src-btn${idx === 0 ? ' active' : ''}`;
      btn.textContent = label;
      btn.addEventListener('click', () => {
        switcher.querySelectorAll('.src-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        loadFootballStream(url);
      });
      switcher.appendChild(btn);

      if (!firstLoaded) { firstLoaded = true; loadFootballStream(url); }
    });
  });

  if (!firstLoaded) {
    switcher.innerHTML += '<span style="font-size:12px;color:var(--red)">Streams unavailable right now</span>';
  }
}

function loadFootballStream(url) {
  const iframe = document.getElementById('player-iframe');
  if (url.includes('.m3u8')) {
    // Build an inline HLS player using hls.js
    const html = `<!DOCTYPE html><html><head><meta charset="UTF-8">
<style>*{margin:0;padding:0;box-sizing:border-box}body{background:#000}video{width:100%;height:100vh;display:block}</style>
</head><body>
<video id="v" controls autoplay playsinline></video>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"><\/script>
<script>
const v=document.getElementById('v');
const src="${url.replace(/"/g, '\\"')}";
if(Hls.isSupported()){const h=new Hls({enableWorker:true});h.loadSource(src);h.attachMedia(v);h.on(Hls.Events.MANIFEST_PARSED,()=>v.play().catch(()=>{}));}
else if(v.canPlayType('application/vnd.apple.mpegurl')){v.src=src;v.play().catch(()=>{});}
<\/script></body></html>`;
    iframe.src = 'about:blank';
    iframe.onload = function() {
      try {
        iframe.contentDocument.open();
        iframe.contentDocument.write(html);
        iframe.contentDocument.close();
      } catch(_) {
        // Cross-origin fallback - open in new tab
        window.open(url, '_blank');
      }
      iframe.onload = null;
    };
    iframe.src = 'about:blank';
  } else {
    iframe.src = url;
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SETTINGS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function loadSettings() {
  try {
    const saved = localStorage.getItem(SETTINGS_KEY);
    if (saved) state.settings = { ...state.settings, ...JSON.parse(saved) };
  } catch (_) {}
  applySettings();
  state.currentSource = state.settings.source;
}

function applySettings() {
  document.documentElement.style.setProperty('--accent', state.settings.accent);
  let styleEl = document.getElementById('dyn-card-style');
  if (!styleEl) {
    styleEl = document.createElement('style');
    styleEl.id = 'dyn-card-style';
    document.head.appendChild(styleEl);
  }
  styleEl.textContent = `.cards-grid{grid-template-columns:repeat(auto-fill,minmax(${state.settings.cardSize}px,1fr))}`;
}

function openSettings() {
  const modal = document.getElementById('settings-modal');
  modal.classList.add('active');
  // Sync UI state
  document.querySelectorAll('#settings-src-btns .settings-src-btn').forEach(btn =>
    btn.classList.toggle('active', btn.dataset.src === state.settings.source));
  document.querySelectorAll('#settings-color-btns .color-btn').forEach(btn =>
    btn.classList.toggle('active', btn.dataset.color === state.settings.accent));
  document.querySelectorAll('#settings-size-btns .settings-src-btn').forEach(btn =>
    btn.classList.toggle('active', parseInt(btn.dataset.size, 10) === state.settings.cardSize));
}

function closeSettings() {
  document.getElementById('settings-modal').classList.remove('active');
}

function saveSettings() {
  const srcBtn   = document.querySelector('#settings-src-btns .settings-src-btn.active');
  const colorBtn = document.querySelector('#settings-color-btns .color-btn.active');
  const sizeBtn  = document.querySelector('#settings-size-btns .settings-src-btn.active');
  if (srcBtn)   state.settings.source   = srcBtn.dataset.src;
  if (colorBtn) state.settings.accent   = colorBtn.dataset.color;
  if (sizeBtn)  state.settings.cardSize = parseInt(sizeBtn.dataset.size, 10);
  try { localStorage.setItem(SETTINGS_KEY, JSON.stringify(state.settings)); } catch (_) {}
  applySettings();
  state.currentSource = state.settings.source;
  // Sync source buttons in player
  document.querySelectorAll('#source-switcher .src-btn').forEach(b =>
    b.classList.toggle('active', b.dataset.src === state.currentSource));
  closeSettings();
}

function resetSettings() {
  state.settings = { source: 'vidsrc', accent: '#e8c96d', cardSize: 160 };
  try { localStorage.removeItem(SETTINGS_KEY); } catch (_) {}
  applySettings();
  openSettings();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   EVENT WIRING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function wireEvents() {
  // Header nav
  document.querySelectorAll('#main-nav .nav-btn').forEach(btn =>
    btn.addEventListener('click', () => showTab(btn.dataset.tab)));

  // Mobile nav
  document.querySelectorAll('.mob-btn[data-tab]').forEach(btn =>
    btn.addEventListener('click', () => showTab(btn.dataset.tab)));
  document.getElementById('mob-settings')?.addEventListener('click', openSettings);

  // Settings
  document.getElementById('settings-btn')?.addEventListener('click', openSettings);
  document.getElementById('settings-close')?.addEventListener('click', closeSettings);
  document.getElementById('settings-save')?.addEventListener('click', saveSettings);
  document.getElementById('settings-reset')?.addEventListener('click', resetSettings);
  document.getElementById('settings-modal')?.addEventListener('click', e => { if (e.target === e.currentTarget) closeSettings(); });

  // Settings button group toggles (delegated)
  document.getElementById('settings-src-btns')?.addEventListener('click', e => {
    const btn = e.target.closest('.settings-src-btn');
    if (btn) {
      document.querySelectorAll('#settings-src-btns .settings-src-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
    }
  });
  document.getElementById('settings-color-btns')?.addEventListener('click', e => {
    const btn = e.target.closest('.color-btn');
    if (btn) {
      document.querySelectorAll('#settings-color-btns .color-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
    }
  });
  document.getElementById('settings-size-btns')?.addEventListener('click', e => {
    const btn = e.target.closest('.settings-src-btn');
    if (btn) {
      document.querySelectorAll('#settings-size-btns .settings-src-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
    }
  });

  // Player close
  document.getElementById('player-close')?.addEventListener('click', closePlayer);
  document.getElementById('player-modal')?.addEventListener('click', e => { if (e.target === e.currentTarget) closePlayer(); });

  // ESC key
  document.addEventListener('keydown', e => { if (e.key === 'Escape') { closePlayer(); closeSettings(); } });

  // Movies tab buttons
  document.querySelectorAll('#movies-tab .tab-btns .tab-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelectorAll('#movies-tab .tab-btns .tab-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      if (btn.dataset.franchise) {
        showFranchises();
      } else {
        const type = btn.dataset.movieType;
        document.getElementById('franchise-view').style.display = 'none';
        document.getElementById('movies-grid').style.display = '';
        document.getElementById('movie-genres').style.display = '';
        document.getElementById('scream-section').style.display = type === 'popular' ? '' : 'none';
        fetchMovies(type);
      }
    });
  });

  // TV tab buttons
  document.querySelectorAll('#tv-tab .tab-btns .tab-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelectorAll('#tv-tab .tab-btns .tab-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      fetchTV(btn.dataset.tvType);
    });
  });

  // Episode selectors
  document.getElementById('season-select')?.addEventListener('change', loadEpisodes);
  document.getElementById('episode-select')?.addEventListener('change', setEpisode);

  // Football league filter
  document.querySelectorAll('.league-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelectorAll('.league-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      state.leagueFilter = btn.dataset.league;
      applyMatchFilters();
    });
  });

  // Football search
  let matchSearchTimer;
  document.getElementById('match-search')?.addEventListener('input', e => {
    clearTimeout(matchSearchTimer);
    matchSearchTimer = setTimeout(() => {
      state.matchQuery = e.target.value.trim().toLowerCase();
      applyMatchFilters();
    }, 300);
  });

  // Football refresh
  document.getElementById('football-refresh')?.addEventListener('click', () => {
    state.footballLoaded = false;
    loadFootball();
  });

  // Mobile nav visibility on resize
  window.addEventListener('resize', () => {
    const nav = document.getElementById('mobile-nav');
    if (nav && document.body.classList.contains('authenticated')) {
      nav.style.display = window.innerWidth <= 768 ? 'flex' : 'none';
    }
  });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   INIT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function initApp() {
  loadSettings();
  wireEvents();
  loadHero();
  fetchMovies('popular');
  loadGenres();
  loadScreamRow();
}
</script>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     AUTH SCRIPT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
(async function auth() {
  const LS_KEY = 'cs_auth_v2';
  let HASH = '';

  try {
    const res = await fetch('/api/config');
    const data = await res.json();
    HASH = (data.hash || '').toLowerCase().trim();
  } catch (_) {
    HASH = '';
  }

  if (!HASH) {
    document.getElementById('pw-error').textContent = 'Auth configuration error. Contact admin.';
    document.getElementById('pw-submit').disabled = true;
    return;
  }

  async function sha256(str) {
    const buf = await crypto.subtle.digest('SHA-256', new TextEncoder().encode(str));
    return Array.from(new Uint8Array(buf)).map(b => b.toString(16).padStart(2, '0')).join('');
  }

  function unlock() {
    document.getElementById('pw-gate').style.display  = 'none';
    document.body.classList.add('authenticated');
    document.body.style.overflow = '';
    if (window.innerWidth <= 768) {
      document.getElementById('mobile-nav').style.display = 'flex';
    }
    initApp();
  }

  // Check persisted auth
  if (HASH && localStorage.getItem(LS_KEY) === HASH) {
    unlock();
    return;
  }

  // Show gate
  document.body.style.overflow = 'hidden';
  document.getElementById('pw-input').focus();

  async function attempt() {
    const input = document.getElementById('pw-input');
    const errEl = document.getElementById('pw-error');
    const val   = input.value;
    if (!val) { errEl.textContent = 'Please enter the password.'; return; }
    const h = await sha256(val);
    if (h === HASH) {
      try { localStorage.setItem(LS_KEY, HASH); } catch (_) {}
      unlock();
    } else {
      errEl.textContent = 'Incorrect password. Try again.';
      input.value = '';
      input.focus();
    }
  }

  document.getElementById('pw-submit').addEventListener('click', attempt);
  document.getElementById('pw-input').addEventListener('keydown', e => { if (e.key === 'Enter') attempt(); });
})();
</script>

</body>
</html>